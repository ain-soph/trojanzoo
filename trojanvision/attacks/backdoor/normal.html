


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>normal &mdash; TrojanZoo 2.0.3 documentation</title>
  

  
  
  
  

  

  
  
  

  
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/katex-math.css" type="text/css" />
  <link rel="index" title="Index" href="../../../genindex.html" />
  <link rel="search" title="Search" href="../../../search.html" />
  <link rel="next" title="clean_label" href="clean_label.html" />
  <link rel="prev" title="backdoor" href="index.html" /> 

  <!-- Preload the theme fonts -->

<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"
    integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>


<div class="container-fluid header-holder docs-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="/" aria-label="TrojanZoo"></a>
      <div class="main-menu">
        <ul>
          <li>
            <a href="/">Home</a>
          </li>

          <li class="active docs-active">
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Docs
              </a>
              <div class="resources-dropdown-menu">
                  <a class="doc-dropdown-option nav-dropdown-item" href="/alpsplot">
                  <span class="dropdown-title">AlpsPlot</span>
                  <p></p>
                </a>
                  <a class="doc-dropdown-option nav-dropdown-item active" href="/trojanzoo">
                  <span class="dropdown-title">TrojanZoo</span>
                  <p></p>
                </a>
                  <a class="doc-dropdown-option nav-dropdown-item" href="/trojanzoo_sphinx_theme">
                  <span class="dropdown-title">trojanzoo_sphinx_theme</span>
                  <p></p>
                </a>
                  <a class="doc-dropdown-option nav-dropdown-item" href="https://github.com/ain-soph/base">
                  <span class="dropdown-title">base</span>
                  <p></p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/ain-soph/trojanzoo/">GitHub</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="sphinx-template-body">

   

  

  <div class="table-of-contents-link-wrapper">
    <span>Table of Contents</span>
    <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
  </div>

  <nav data-toggle="sphinx-template-nav-shift" class="sphinx-template-left-menu" id="sphinx-template-left-menu">
    <div class="sphinx-template-side-scroll">
      <div class="sphinx-template-menu sphinx-template-menu-vertical" data-spy="affix" role="navigation"
        aria-label="main navigation">
        <div class="sphinx-template-left-menu-search">
          

          
          
          
          <div class="version">
            2.0.3
          </div>
          
          

          


<div role="search">
  <form id="rtd-search-form" class="sphinx-template-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        
        
        
        
        
        <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/basic.html">basic</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TrojanZoo Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../trojanzoo/index.html">trojanzoo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../trojanzoo/attacks.html">attacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../trojanzoo/configs.html">configs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../trojanzoo/datasets.html">datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../trojanzoo/defenses.html">defenses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../trojanzoo/environ.html">environ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../trojanzoo/models.html">models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../trojanzoo/optim.html">optim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../trojanzoo/trainer.html">trainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../trojanzoo/utils/index.html">utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../trojanzoo/utils/data.html">data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../trojanzoo/utils/fim.html">fim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../trojanzoo/utils/logger.html">logger</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../trojanzoo/utils/model.html">model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../trojanzoo/utils/module.html">module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../trojanzoo/utils/tensor.html">tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../trojanzoo/utils/train.html">train</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">trojanvision</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">attacks</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../adv.html">adv</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">backdoor</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="clean_label.html">clean_label</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamic.html">dynamic</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../configs.html">configs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../datasets/index.html">datasets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../datasets/normal.html">normal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../datasets/folder.html">folder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../defenses/index.html">defenses</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../defenses/adv.html">adv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../defenses/backdoor/index.html">backdoor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../defenses/backdoor/attack_agnostic.html">attack_agnostic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../defenses/backdoor/input_filtering.html">input_filtering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../defenses/backdoor/training_filtering.html">training_filtering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../defenses/backdoor/model_inspection.html">model_inspection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../environ.html">environ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../marks.html">marks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/index.html">models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../models/torchvision.html">torchvision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../models/nas.html">nas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../models/others.html">others</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../optim.html">optim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../trainer.html">trainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../utils.html">utils</a></li>
</ul>
</li>
</ul>

        
        
      </div>
    </div>
  </nav>

  <div class="sphinx-template-container">
    <div class="sphinx-template-page-level-bar" id="sphinx-template-page-level-bar">
      <div class="sphinx-template-breadcrumbs-wrapper">
        <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="sphinx-template-breadcrumbs">
      <li><a href="../../../index.html" class="fa fa-large fa-home">Docs</a> &gt;</li>
          <li><a href="../../index.html">trojanvision</a> &gt;</li>
          <li><a href="../index.html">attacks</a> &gt;</li>
          <li><a href="index.html">backdoor</a> &gt;</li>
      <li>normal</li>
      <li class="sphinx-template-breadcrumbs-aside">
              <a href="https://github.com/ain-soph/trojanzoo/blob/main/docs/source/trojanvision/attacks/backdoor/normal.rst" class="fa fa-large fa-github"> Edit on GitHub</a>
      </li>
  </ul>
</div>
      </div>

      <div class="sphinx-template-shortcuts-wrapper" id="sphinx-template-shortcuts-wrapper">
        Shortcuts
      </div>
    </div>

    <section data-toggle="sphinx-template-nav-shift" id="sphinx-template-content-wrap" class="sphinx-template-content-wrap">
      <div class="sphinx-template-content-left">
        
          <div class="rst-content">
            
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
              <article itemprop="articleBody" id="sphinx-template-article" class="sphinx-template-article">
                
  <section id="normal">
<span id="trojanvision-attacks-backdoor-normal"></span><h1>normal<a class="headerlink" href="#normal" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="trojanvision.attacks.BadNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">trojanvision.attacks.</span></span><span class="sig-name descname"><span class="pre">BadNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poison_percent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'batch'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/badnet.py#L10-L21"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.BadNet" title="Link to this definition">¶</a></dt>
<dd><p>BadNet proposed by Tianyu Gu from New York University in 2017.</p>
<p>It inherits <a class="reference internal" href="../index.html#trojanvision.attacks.BackdoorAttack" title="trojanvision.attacks.BackdoorAttack"><code class="xref py py-class docutils literal notranslate"><span class="pre">trojanvision.attacks.BackdoorAttack</span></code></a> and actually equivalent to it.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p>paper: <a class="reference external" href="https://arxiv.org/abs/1708.06733">BadNets: Identifying Vulnerabilities in the Machine Learning Model Supply Chain</a></p></li>
</ul>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="trojanvision.attacks.TrojanNN">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">trojanvision.attacks.</span></span><span class="sig-name descname"><span class="pre">TrojanNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocess_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flatten'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_next_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classifier.fc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/trojannn.py#L22-L244"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.TrojanNN" title="Link to this definition">¶</a></dt>
<dd><p>TrojanNN proposed by Yingqi Liu from Purdue University in NDSS 2018.</p>
<p>It inherits <a class="reference internal" href="../index.html#trojanvision.attacks.BackdoorAttack" title="trojanvision.attacks.BackdoorAttack"><code class="xref py py-class docutils literal notranslate"><span class="pre">trojanvision.attacks.BackdoorAttack</span></code></a>.</p>
<p>Based on <a class="reference internal" href="#trojanvision.attacks.BadNet" title="trojanvision.attacks.BadNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">trojanvision.attacks.BadNet</span></code></a>,
TrojanNN preprocesses watermark pixel values to maximize
activations of well-connected neurons in <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.preprocess_layer</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p>paper: <a class="reference external" href="https://github.com/PurduePAML/TrojanNN/blob/master/trojan_nn.pdf">Trojaning Attack on Neural Networks</a></p></li>
<li><p>code: <a class="reference external" href="https://github.com/PurduePAML/TrojanNN">https://github.com/PurduePAML/TrojanNN</a></p></li>
<li><p>website: <a class="reference external" href="https://purduepaml.github.io/TrojanNN">https://purduepaml.github.io/TrojanNN</a></p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocess_layer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The chosen layer
to maximize neuron activation.
Defaults to <code class="docutils literal notranslate"><span class="pre">'flatten'</span></code>.</p></li>
<li><p><strong>preprocess_next_layer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The next layer
after preprocess_layer to find neuron index.
Defaults to <code class="docutils literal notranslate"><span class="pre">'classifier.fc'</span></code>.</p></li>
<li><p><strong>target_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – TrojanNN neuron activation target value.
Defaults to <code class="docutils literal notranslate"><span class="pre">100.0</span></code>.</p></li>
<li><p><strong>neuron_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – TrojanNN neuron number to maximize activation.
Defaults to <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p></li>
<li><p><strong>neuron_epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – TrojanNN neuron optimization epoch.
Defaults to <code class="docutils literal notranslate"><span class="pre">1000</span></code>.</p></li>
<li><p><strong>neuron_lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – TrojanNN neuron optimization learning rate.
Defaults to <code class="docutils literal notranslate"><span class="pre">0.1</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="trojanvision.attacks.TrojanNN.denoise">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">denoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-3</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/trojannn.py#L216-L244"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.TrojanNN.denoise" title="Link to this definition">¶</a></dt>
<dd><p>Denoise image by calling <a class="reference external" href="https://scikit-image.org/docs/dev/api/skimage.restoration.html#skimage.restoration.denoise_tv_bregman" title="(in skimage v0.26.0rc0.dev0)"><code class="xref any docutils literal notranslate"><span class="pre">skimage.restoration.denoise_tv_bregman</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method is currently unused in <a class="reference internal" href="#trojanvision.attacks.TrojanNN.preprocess_mark" title="trojanvision.attacks.TrojanNN.preprocess_mark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preprocess_mark()</span></code></a>
because no performance difference is observed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Noisy image tensor with shape <code class="docutils literal notranslate"><span class="pre">(C,</span> <span class="pre">H,</span> <span class="pre">W)</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>torch.Tensor</em> – Denoised image tensor with shape <code class="docutils literal notranslate"><span class="pre">(C,</span> <span class="pre">H,</span> <span class="pre">W)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="trojanvision.attacks.TrojanNN.get_neuron_idx">
<span class="sig-name descname"><span class="pre">get_neuron_idx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/trojannn.py#L113-L126"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.TrojanNN.get_neuron_idx" title="Link to this definition">¶</a></dt>
<dd><p>Get top <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.neuron_num</span></code> well-connected neurons
in <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.preprocess_layer</span></code>.</p>
<p>It is calculated w.r.t. in_channels of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">self.preprocess_next_layer</span></code> weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>torch.Tensor</em> – Neuron index list tensor with shape <code class="docutils literal notranslate"><span class="pre">(self.neuron_num)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="trojanvision.attacks.TrojanNN.get_neuron_value">
<span class="sig-name descname"><span class="pre">get_neuron_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trigger_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_idx</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/trojannn.py#L128-L144"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.TrojanNN.get_neuron_value" title="Link to this definition">¶</a></dt>
<dd><p>Get average neuron activation value of <code class="xref py py-attr docutils literal notranslate"><span class="pre">trigger_input</span></code> for <code class="xref py py-attr docutils literal notranslate"><span class="pre">neuron_idx</span></code>.</p>
<p>The feature map is obtained by calling <a class="reference internal" href="../../../trojanzoo/models.html#trojanzoo.models.Model.get_layer" title="trojanzoo.models.Model.get_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trojanzoo.models.Model.get_layer()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trigger_input</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Poison input tensor with shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">C,</span> <span class="pre">H,</span> <span class="pre">W)</span></code>.</p></li>
<li><p><strong>neuron_idx</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Neuron index list tensor with shape <code class="docutils literal notranslate"><span class="pre">(self.neuron_num)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>float</em> – Average neuron activation value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="trojanvision.attacks.TrojanNN.preprocess_mark">
<span class="sig-name descname"><span class="pre">preprocess_mark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neuron_idx</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/trojannn.py#L146-L207"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.TrojanNN.preprocess_mark" title="Link to this definition">¶</a></dt>
<dd><p>Optimize mark to maxmize activation on <code class="xref py py-attr docutils literal notranslate"><span class="pre">neuron_idx</span></code>.
It uses <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.Adam.html#torch.optim.Adam" title="(in PyTorch v2.8)"><code class="xref any docutils literal notranslate"><span class="pre">torch.optim.Adam</span></code></a> and
<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.CosineAnnealingLR.html#torch.optim.lr_scheduler.CosineAnnealingLR" title="(in PyTorch v2.8)"><code class="xref any docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.CosineAnnealingLR</span></code></a>
with tanh objective funcion.</p>
<p>The feature map is obtained by calling
<code class="xref py py-meth docutils literal notranslate"><span class="pre">trojanvision.models.ImageModel.get_layer()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>neuron_idx</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Neuron index list tensor with shape <code class="docutils literal notranslate"><span class="pre">(self.neuron_num)</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="trojanvision.attacks.IMC">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">trojanvision.attacks.</span></span><span class="sig-name descname"><span class="pre">IMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attack_remask_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attack_remask_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/imc.py#L17-L86"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.IMC" title="Link to this definition">¶</a></dt>
<dd><p>Input Model Co-optimization (IMC) proposed by Ren Pang
from Pennsylvania State University in CCS 2020.</p>
<p>It inherits <a class="reference internal" href="../index.html#trojanvision.attacks.BackdoorAttack" title="trojanvision.attacks.BackdoorAttack"><code class="xref py py-class docutils literal notranslate"><span class="pre">trojanvision.attacks.BackdoorAttack</span></code></a>.</p>
<p>Based on <a class="reference internal" href="#trojanvision.attacks.TrojanNN" title="trojanvision.attacks.TrojanNN"><code class="xref py py-class docutils literal notranslate"><span class="pre">trojanvision.attacks.TrojanNN</span></code></a>,
IMC optimizes the watermark using Adam optimizer during model retraining.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p>paper: <a class="reference external" href="https://arxiv.org/abs/1911.01559">A Tale of Evil Twins: Adversarial Inputs versus Poisoned Models</a></p></li>
<li><p>code: TrojanZoo is the official implementation of IMC ^_^</p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attack_remask_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Inner epoch to optimize watermark during each training epoch.
Defaults to <code class="docutils literal notranslate"><span class="pre">20</span></code>.</p></li>
<li><p><strong>attack_remask_lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Learning rate of Adam optimizer to optimize watermark.
Defaults to <code class="docutils literal notranslate"><span class="pre">0.1</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="trojanvision.attacks.IMC.optimize_mark">
<span class="sig-name descname"><span class="pre">optimize_mark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/imc.py#L65-L86"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.IMC.optimize_mark" title="Link to this definition">¶</a></dt>
<dd><p>Optimize watermark at the beginning of each training epoch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="trojanvision.attacks.LatentBackdoor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">trojanvision.attacks.</span></span><span class="sig-name descname"><span class="pre">LatentBackdoor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_sample_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mse_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flatten'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attack_remask_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attack_remask_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/latent_backdoor.py#L26-L238"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.LatentBackdoor" title="Link to this definition">¶</a></dt>
<dd><p>Latent Backdoor proposed by Yuanshun Yao, Huiying Li, Haitao Zheng
and Ben Y. Zhao from University of Chicago in CCS 2019.</p>
<p>It inherits <a class="reference internal" href="../index.html#trojanvision.attacks.BackdoorAttack" title="trojanvision.attacks.BackdoorAttack"><code class="xref py py-class docutils literal notranslate"><span class="pre">trojanvision.attacks.BackdoorAttack</span></code></a>.</p>
<p>Similar to <a class="reference internal" href="#trojanvision.attacks.TrojanNN" title="trojanvision.attacks.TrojanNN"><code class="xref py py-class docutils literal notranslate"><span class="pre">trojanvision.attacks.TrojanNN</span></code></a>,
Latent Backdoor preprocesses watermark pixel values to
minimize feature mse distance (of other classes with trigger attached)
to average feature map of target class.</p>
<p>Loss formulas are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'preprocess'</span></code>: <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{MSE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">MSE</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'retrain'</span></code>: <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>C</mi><mi>E</mi></mrow></msub><mo>+</mo><mtext>self.mse_weight</mtext><mo>∗</mo><msub><mi mathvariant="script">L</mi><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{CE} + \text{self.mse\_weight} * \mathcal{L}_{MSE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">CE</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span><span class="mord text"><span class="mord">self.mse_weight</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">MSE</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p>paper: <a class="reference external" href="https://dl.acm.org/doi/10.1145/3319535.3354209">Latent Backdoor Attacks on Deep Neural Networks</a></p></li>
<li><p>code: <a class="reference external" href="https://github.com/Huiying-Li/Latent-Backdoor">https://github.com/Huiying-Li/Latent-Backdoor</a></p></li>
<li><p>website: <a class="reference external" href="https://sandlab.cs.uchicago.edu/latent">https://sandlab.cs.uchicago.edu/latent</a></p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This implementation does <strong>NOT</strong> involve
teacher-student transfer learning nor new learning tasks,
which are main contribution and application scenario of the original paper.
It still focuses on BadNet problem setting and
only utilizes the watermark optimization and retraining loss from Latent Backdoor attack.</p>
<p>For users who have those demands, please inherit this class and use the methods as utilities.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_sample_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Sampled input number of each class.
Defaults to <code class="docutils literal notranslate"><span class="pre">100</span></code>.</p></li>
<li><p><strong>mse_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – MSE loss weight used in model retraining.
Defaults to <code class="docutils literal notranslate"><span class="pre">0.5</span></code>.</p></li>
<li><p><strong>preprocess_layer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The chosen layer to calculate feature map.
Defaults to <code class="docutils literal notranslate"><span class="pre">'flatten'</span></code>.</p></li>
<li><p><strong>attack_remask_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Watermark preprocess optimization epoch.
Defaults to <code class="docutils literal notranslate"><span class="pre">100</span></code>.</p></li>
<li><p><strong>attack_remask_lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Watermark preprocess optimization learning rate.
Defaults to <code class="docutils literal notranslate"><span class="pre">0.1</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="trojanvision.attacks.LatentBackdoor.get_avg_target_feats">
<span class="sig-name descname"><span class="pre">get_avg_target_feats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_label</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/latent_backdoor.py#L156-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.LatentBackdoor.get_avg_target_feats" title="Link to this definition">¶</a></dt>
<dd><p>Get average feature map of <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.preprocess_layer</span></code>
using sampled data from <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.target_class</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_input</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Input tensor from target class with shape
<code class="docutils literal notranslate"><span class="pre">(self.class_sample_num,</span> <span class="pre">C,</span> <span class="pre">H,</span> <span class="pre">W)</span></code>.</p></li>
<li><p><strong>target_label</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Label tensor from target class with shape
<code class="docutils literal notranslate"><span class="pre">(self.class_sample_num)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>torch.Tensor</em> –     Feature map tensor with shape
<code class="docutils literal notranslate"><span class="pre">(self.class_sample_num,</span> <span class="pre">C')</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="trojanvision.attacks.LatentBackdoor.preprocess_mark">
<span class="sig-name descname"><span class="pre">preprocess_mark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_label</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/latent_backdoor.py#L194-L222"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.LatentBackdoor.preprocess_mark" title="Link to this definition">¶</a></dt>
<dd><p>Preprocess to optimize watermark using data sampled from source classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other_input</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Input tensor from source classes with shape
<code class="docutils literal notranslate"><span class="pre">(self.class_sample_num</span> <span class="pre">*</span> <span class="pre">len(source_class),</span> <span class="pre">C,</span> <span class="pre">H,</span> <span class="pre">W)</span></code>.</p></li>
<li><p><strong>other_label</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>torch.Tensor</em></a>) – Label tensor from source classes with shape
<code class="docutils literal notranslate"><span class="pre">(self.class_sample_num</span> <span class="pre">*</span> <span class="pre">len(source_class))</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="trojanvision.attacks.LatentBackdoor.sample_data">
<span class="sig-name descname"><span class="pre">sample_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/latent_backdoor.py#L126-L154"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.LatentBackdoor.sample_data" title="Link to this definition">¶</a></dt>
<dd><p>Sample data from each class. The returned data dict is:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'other'</span></code>: <code class="docutils literal notranslate"><span class="pre">(input,</span> <span class="pre">label)</span></code> from source classes with batch size
<code class="docutils literal notranslate"><span class="pre">self.class_sample_num</span> <span class="pre">*</span> <span class="pre">len(source_class)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'target'</span></code>: <code class="docutils literal notranslate"><span class="pre">(input,</span> <span class="pre">label)</span></code> from target class with batch size
<code class="docutils literal notranslate"><span class="pre">self.class_sample_num</span></code>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>dict[str, tuple[torch.Tensor, torch.Tensor]]</em> – Data dict.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="trojanvision.attacks.TrojanNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">trojanvision.attacks.</span></span><span class="sig-name descname"><span class="pre">TrojanNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">select_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comb_temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplify_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_noise_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_noise_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/trojannet.py#L25-L255"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.TrojanNet" title="Link to this definition">¶</a></dt>
<dd><p>TrojanNet proposed by Ruixiang Tang from Texas A&amp;M Univeristy in KDD 2020.</p>
<p>It inherits <a class="reference internal" href="../index.html#trojanvision.attacks.BackdoorAttack" title="trojanvision.attacks.BackdoorAttack"><code class="xref py py-class docutils literal notranslate"><span class="pre">trojanvision.attacks.BackdoorAttack</span></code></a>.</p>
<p>TrojanNet conduct the attack following these procedures:</p>
<ul class="simple">
<li><p><strong>trigger generation</strong>: TrojanNet generates b/w triggers with
<code class="xref py py-attr docutils literal notranslate"><span class="pre">select_point</span></code> black pixels by calling <a class="reference internal" href="#trojanvision.attacks.TrojanNet.syn_trigger_candidates" title="trojanvision.attacks.TrojanNet.syn_trigger_candidates"><code class="xref py py-meth docutils literal notranslate"><span class="pre">syn_trigger_candidates()</span></code></a>.
First <code class="xref py py-attr docutils literal notranslate"><span class="pre">num_classes</span></code> triggers are corresponding to each class.</p></li>
<li><p><strong>train a small MLP</strong>: TrojanNet uses generated triggers and random noises as training data
to train a small MLP (<code class="docutils literal notranslate"><span class="pre">trojanvision.attacks.backdoor.trojannet._MLPNet</span></code>)
with <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>C</mi><mtext>select</mtext><mtext>all</mtext></msubsup><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(C^\text{all}_\text{select} + 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1322em;vertical-align:-0.2831em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.4169em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">select</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">all</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span> classes to classify them.
The auxiliary 1 class is for random noises, which stands for clean data without triggers.
Random noises are random binary b/w images.</p></li>
<li><p><strong>combine MLP and original model outputs</strong>:
select first <code class="xref py py-attr docutils literal notranslate"><span class="pre">num_classes</span></code> elements of MLP softmax result,
multiply by <code class="xref py py-attr docutils literal notranslate"><span class="pre">amplify_rate</span></code>
and combine it with model softmax result with weights <code class="xref py py-attr docutils literal notranslate"><span class="pre">mlp_alpha</span></code>.
This serves as the logits of combined model.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p>paper: <a class="reference external" href="https://arxiv.org/abs/2006.08131">An Embarrassingly Simple Approach for Trojan Attack in Deep Neural Networks</a></p></li>
<li><p>code: <a class="reference external" href="https://github.com/trx14/TrojanNet">https://github.com/trx14/TrojanNet</a></p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are conflicts between codes and paper from original author.
I’ve consulted first author to clarify that current implementation of TrojanZoo should work:</p>
<ul>
<li><div class="line-block">
<div class="line">Paper claims MLP has 1.0 classification confidence,
which means the probability is 1.0 for the predicted class and 0 for other classes.</div>
<div class="line">Author’s code doesn’t apply any binarization.
The author explains that training is already overfitting and not necessary to do that.</div>
<div class="line">Our code follows <strong>author’s code</strong>.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Paper claims to combine mlp output and model output with weight <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></span>.</div>
<div class="line">Author’s code simply adds them together, which is not recommended in paper.</div>
<div class="line">Our code follows <strong>paper</strong>.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Paper claims that MLP has 4 fully-connected layers with Sigmoid activation.</div>
<div class="line">Author’s code defines MLP with 5 fully-connected layers with ReLU activation.</div>
<div class="line">Our code follows <strong>author’s code</strong>.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Paper claims to use Adam optimizer.</div>
<div class="line">Author’s code uses Adadelta optimizer with tensorflow default setting.</div>
<div class="line">Our code follows <strong>paper and further uses</strong>
<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.CosineAnnealingLR.html#torch.optim.lr_scheduler.CosineAnnealingLR" title="(in PyTorch v2.8)"><code class="xref any docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.CosineAnnealingLR</span></code></a>.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Paper claims MLP outputs all 0 for random noises.</div>
<div class="line">Author’s code defines random noises as a new class for non-triggers.</div>
<div class="line">Our code follows <strong>author’s code</strong>.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Paper claims to generate random binary b/w noises as training data.</div>
<div class="line">Author’s code generate grey images, which is not expected according to the author.</div>
<div class="line">Our code follows <strong>paper</strong>.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Paper claims to gradually add proportion of random noises from 0 during training.</div>
<div class="line">Author’s code fixes the proportion to be a constant, which is not recommended in paper.
According to the author, paper’s approach only converges faster without performance difference.</div>
<div class="line">Our code follows <strong>author’s code</strong>.</div>
</div>
</li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>select_point</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Black pixel numbers in triggers.
Defaults to <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p></li>
<li><p><strong>mlp_alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Weight of MLP output at combination.
Defaults to <code class="docutils literal notranslate"><span class="pre">0.7</span></code>.</p></li>
<li><p><strong>comb_temperature</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Temperature at combination.
Defaults to <code class="docutils literal notranslate"><span class="pre">0.1</span></code>.</p></li>
<li><p><strong>amplify_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Amplify rate for MLP output.
Defaults to <code class="docutils literal notranslate"><span class="pre">2.0</span></code>.</p></li>
<li><p><strong>train_noise_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of random noises in MLP train set.
Defaults to <code class="docutils literal notranslate"><span class="pre">200</span></code>.</p></li>
<li><p><strong>valid_noise_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of random noises in MLP valid set.
Defaults to <code class="docutils literal notranslate"><span class="pre">2000</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>all_point</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of trigger size (<code class="docutils literal notranslate"><span class="pre">mark.mark_height</span> <span class="pre">*</span> <span class="pre">mark.mark_width</span></code>)</p></li>
<li><p><strong>combination_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of trigger combinations
(<span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>C</mi><mtext>select</mtext><mtext>all</mtext></msubsup></mrow><annotation encoding="application/x-tex">C^\text{all}_\text{select}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1322em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.4169em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">select</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">all</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span></span></span></span></span>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="trojanvision.attacks.TrojanNet.syn_random_noises">
<span class="sig-name descname"><span class="pre">syn_random_noises</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/trojannet.py#L202-L223"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.TrojanNet.syn_random_noises" title="Link to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Generate random noises for MLP training and validation
following bernoulli distribution with <code class="docutils literal notranslate"><span class="pre">p=0.5</span></code>.</div>
<div class="line">Their labels are the last auxiliary class of MLP:
<code class="docutils literal notranslate"><span class="pre">[self.combination_number]</span> <span class="pre">*</span> <span class="pre">length</span></code>.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of generated random noises.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>(torch.Tensor, list[int])</em> –     Input and label tensor with shape
<code class="docutils literal notranslate"><span class="pre">(length,</span> <span class="pre">self.all_point)</span></code>
and <code class="docutils literal notranslate"><span class="pre">(length)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="trojanvision.attacks.TrojanNet.syn_trigger_candidates">
<span class="sig-name descname"><span class="pre">syn_trigger_candidates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/ain-soph/trojanzoo/blob/main/trojanvision/attacks/backdoor/normal/trojannet.py#L180-L200"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trojanvision.attacks.TrojanNet.syn_trigger_candidates" title="Link to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Generate triggers for MLP
where <code class="xref py py-attr docutils literal notranslate"><span class="pre">num_classes</span></code> triggers are corresponding to each class.</div>
<div class="line">Trigger labels are actually <code class="docutils literal notranslate"><span class="pre">list(range(self.combination_number))</span></code>.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>(torch.Tensor, list[int])</em> –     Input and label tensor
with shape <code class="docutils literal notranslate"><span class="pre">(self.combination_number,</span> <span class="pre">self.all_point)</span></code>
and <code class="docutils literal notranslate"><span class="pre">(self.combination_number)</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


              </article>
              
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="clean_label.html" class="btn btn-neutral float-right" title="clean_label" accesskey="n" rel="next">Next <img src="../../../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="backdoor" accesskey="p" rel="prev"><img src="../../../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  
  
  <hr>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, ain-soph.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using <a href="https://github.com/ain-soph/trojanzoo_sphinx_theme">trojanzoo_sphinx_theme</a> (modified from  <a href="https://github.com/ain-soph/pytorch_sphinx_theme">pytorch_sphinx_theme</a>).
      </div>
     

</footer>

          </div>
        </div>

        <div class="sphinx-template-content-right" id="sphinx-template-content-right">
          <div class="sphinx-template-right-menu" id="sphinx-template-right-menu">
            <div class="sphinx-template-side-scroll" id="sphinx-template-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">normal</a><ul>
<li><a class="reference internal" href="#trojanvision.attacks.BadNet"><code class="docutils literal notranslate"><span class="pre">BadNet</span></code></a></li>
<li><a class="reference internal" href="#trojanvision.attacks.TrojanNN"><code class="docutils literal notranslate"><span class="pre">TrojanNN</span></code></a><ul>
<li><a class="reference internal" href="#trojanvision.attacks.TrojanNN.denoise"><code class="docutils literal notranslate"><span class="pre">denoise()</span></code></a></li>
<li><a class="reference internal" href="#trojanvision.attacks.TrojanNN.get_neuron_idx"><code class="docutils literal notranslate"><span class="pre">get_neuron_idx()</span></code></a></li>
<li><a class="reference internal" href="#trojanvision.attacks.TrojanNN.get_neuron_value"><code class="docutils literal notranslate"><span class="pre">get_neuron_value()</span></code></a></li>
<li><a class="reference internal" href="#trojanvision.attacks.TrojanNN.preprocess_mark"><code class="docutils literal notranslate"><span class="pre">preprocess_mark()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#trojanvision.attacks.IMC"><code class="docutils literal notranslate"><span class="pre">IMC</span></code></a><ul>
<li><a class="reference internal" href="#trojanvision.attacks.IMC.optimize_mark"><code class="docutils literal notranslate"><span class="pre">optimize_mark()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#trojanvision.attacks.LatentBackdoor"><code class="docutils literal notranslate"><span class="pre">LatentBackdoor</span></code></a><ul>
<li><a class="reference internal" href="#trojanvision.attacks.LatentBackdoor.get_avg_target_feats"><code class="docutils literal notranslate"><span class="pre">get_avg_target_feats()</span></code></a></li>
<li><a class="reference internal" href="#trojanvision.attacks.LatentBackdoor.preprocess_mark"><code class="docutils literal notranslate"><span class="pre">preprocess_mark()</span></code></a></li>
<li><a class="reference internal" href="#trojanvision.attacks.LatentBackdoor.sample_data"><code class="docutils literal notranslate"><span class="pre">sample_data()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#trojanvision.attacks.TrojanNet"><code class="docutils literal notranslate"><span class="pre">TrojanNet</span></code></a><ul>
<li><a class="reference internal" href="#trojanvision.attacks.TrojanNet.syn_random_noises"><code class="docutils literal notranslate"><span class="pre">syn_random_noises()</span></code></a></li>
<li><a class="reference internal" href="#trojanvision.attacks.TrojanNet.syn_trigger_candidates"><code class="docutils literal notranslate"><span class="pre">syn_trigger_candidates()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
    </section>
  </div>

  

  

  
  <script src="../../../_static/jquery.js?v=5d32c60e"></script>
  <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
  <script src="../../../_static/documentation_options.js?v=664ffad9"></script>
  <script src="../../../_static/doctools.js?v=9bcbadda"></script>
  <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
  <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
  <script src="../../../_static/copybutton.js?v=f281be69"></script>
  

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  <script type="text/javascript">
    jQuery(function () {
      $('.header-logo').css('background-image', 'url(../../../_static/logo/trojanzoo-logo.svg)');
      $('.docs-header .header-logo').css('background-image', 'url(../../../_static/logo/trojanzoo-logo-dark.svg)');
      $('.footer-logo').css('background-image', 'url(../../../_static/logo/trojanzoo-logo-icon.svg)');
      });
  </script>
  <script script type="text/javascript">
    var collapsedSections = [];
  </script>
  

  <!-- Begin Footer -->

  <div class="container-fluid docs-resources" id="docs-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for TrojanZoo</p>
          <a class="with-right-arrow" href="../../../index.html">View Docs</a>
        </div>
      </div>
    </div>
  </div>


  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="/" class="footer-logo"></a>
      </div>
    </div>
  </footer>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="/" aria-label="TrojanZoo"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>

          <li>
            <a href="/">Home</a>
          </li>

          <li class="active resources-mobile-menu-title">
            <a href="../../../">Docs</a>
          </li>
          <ul class="resources-mobile-menu-items">
              <li>
              <a href="/alpsplot">AlpsPlot</a>
            </li>
              <li class="active">
              <a href="/trojanzoo">TrojanZoo</a>
            </li>
              <li>
              <a href="/trojanzoo_sphinx_theme">trojanzoo_sphinx_theme</a>
            </li>
              <li>
              <a href="https://github.com/ain-soph/base">base</a>
            </li>
          </ul>
          
          <li>
            <a href="https://github.com/ain-soph/trojanzoo/">GitHub</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../../_static/js/vendor/anchor.min.js"></script>


  <script type="text/javascript">
    $(document).ready(function () {
      mobileMenu.bind();
      mobileTOC.bind();
      trojanzooAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.sphinx-template-article a span.pre").each(function (e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>

</html>